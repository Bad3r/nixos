_: {
  perSystem =
    { pkgs, ... }:
    let
      wappalyzerNext = pkgs.callPackage ../../packages/wappalyzer-next { };
      pentestPackages =
        (with pkgs; [
          burpsuite
          nmap
          wireshark
          aircrack-ng
          hydra
          john
          sqlmap
          metasploit
          hashcat
        ])
        ++ [ wappalyzerNext ];
    in
    {
      packages.wappalyzer-next = wappalyzerNext;
      make-shells.pentesting = {
        packages = pentestPackages;
        shellHook = ''
          echo "Pentesting shell ready. Tools: burpsuite, nmap, wireshark, aircrack-ng, hydra, john, sqlmap, metasploit, hashcat, wappalyzer."
          echo "Tip: ensure your user is in the 'wireshark' group to capture packets."
        '';
      };
    };
}
